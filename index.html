<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¨ä¼ç‹›å…‹ï¼</title>
    <style>
        :root {
            --primary-color: #e74c3c;
            --bg-color: #2c3e50;
            --panel-bg: rgba(0, 0, 0, 0.3);
            --text-color: #ecf0f1;
            --btn-color: #3498db;
            --btn-disabled: #7f8c8d;
            --btn-restart: #27ae60;
            --glow-color: #f1c40f;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
        }

        /* ä¸»å®¹å™¨ï¼šå·¦å³ä½ˆå±€ */
        .game-container {
            display: flex;
            flex-direction: row;
            gap: 20px;
            width: 900px;
            max-width: 100%;
        }

        /* å·¦å´é¢æ¿ï¼šè³‡è¨Šèˆ‡æ“ä½œ */
        .left-panel {
            flex: 1;
            background: var(--panel-bg);
            padding: 2rem;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 10px 20px rgba(0,0,0,0.5);
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        /* å³å´é¢æ¿ï¼šæˆ°é¬¥ç´€éŒ„ */
        .right-panel {
            flex: 1;
            background: var(--panel-bg);
            padding: 1rem;
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            box-shadow: 0 10px 20px rgba(0,0,0,0.5);
            max-height: 500px; /* é™åˆ¶é«˜åº¦ */
        }

        h1 { margin-bottom: 20px; font-size: 1.8rem; margin-top: 0; }

        /* æ€ªç‰©åœ–ç¤º */
        .monster-box {
            font-size: 8rem;
            margin: 20px 0;
            transition: transform 0.1s;
            cursor: default;
            user-select: none;
        }
        
        .shake { animation: shake 0.5s; }

        /* HP æ¢å€åŸŸ */
        .hp-bar-container {
            width: 100%;
            background-color: #555;
            height: 30px;
            border-radius: 15px;
            overflow: hidden; /* ç‚ºäº†è®“ bar ä¸è¶…å‡ºåœ“è§’ */
            margin-bottom: 20px;
            position: relative;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.5);
            transition: box-shadow 0.3s;
        }

        /* HP çªç ´ä¸Šé™æ™‚çš„ç™¼å…‰ç‰¹æ•ˆ */
        .hp-bar-container.overheal-glow {
            box-shadow: 0 0 15px var(--glow-color), inset 0 0 10px var(--glow-color);
            border: 2px solid var(--glow-color);
        }

        .hp-bar-fill {
            height: 100%;
            background-color: var(--primary-color);
            width: 100%;
            transition: width 0.3s ease, background-color 0.3s;
        }
        
        /* çªç ´ä¸Šé™æ™‚æ”¹è®Šè¡€æ¢é¡è‰² */
        .overheal-fill {
            background-color: #f39c12 !important; 
        }

        .hp-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 14px;
            font-weight: bold;
            text-shadow: 1px 1px 3px black;
            width: 100%;
            z-index: 2;
        }

        /* æŒ‰éˆ•æ¨£å¼ */
        #action-btn {
            position: relative;
            padding: 15px 0;
            font-size: 1.3rem;
            background-color: var(--btn-color);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            overflow: hidden;
            transition: background 0.3s, transform 0.1s;
            z-index: 1;
            width: 100%;
            font-weight: bold;
        }

        #action-btn:active { transform: scale(0.98); }

        #action-btn:hover:not(:disabled) {
            filter: brightness(1.1);
        }

        #action-btn:disabled {
            background-color: var(--btn-disabled);
            cursor: not-allowed;
            color: #ccc;
        }

        /* ä¸‹ä¸€éš»æŒ‰éˆ•çš„ç‰¹æ®Šè‰² */
        .btn-next {
            background-color: var(--btn-restart) !important;
        }

        .cooldown-overlay {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            width: 0%;
            background-color: rgba(0, 0, 0, 0.3);
            z-index: -1;
        }

        /* è¨Šæ¯æ—¥èªŒå€ */
        .log-area {
            flex: 1;
            overflow-y: auto;
            font-size: 0.95rem;
            text-align: left;
            padding-right: 5px; /* æ²è»¸ç©ºé–“ */
        }
        
        /* è‡ªè¨‚æ²è»¸ */
        .log-area::-webkit-scrollbar { width: 8px; }
        .log-area::-webkit-scrollbar-track { background: rgba(0,0,0,0.1); }
        .log-area::-webkit-scrollbar-thumb { background: #555; border-radius: 4px; }

        .log-header {
            font-size: 1.1rem;
            border-bottom: 2px solid #555;
            padding-bottom: 10px;
            margin-bottom: 10px;
            font-weight: bold;
        }

        .log-entry { margin-bottom: 8px; border-bottom: 1px solid #444; padding-bottom: 4px; word-wrap: break-word;}
        .type-damage { color: #ff7675; }
        .type-heal { color: #55efc4; }
        .type-miss { color: #ffeaa7; }
        .type-system { color: #74b9ff; font-weight: bold; }
        .type-status { color: #a29bfe; font-style: italic; font-weight: bold; }

        @keyframes shake {
            0% { transform: translate(1px, 1px) rotate(0deg); }
            10% { transform: translate(-1px, -2px) rotate(-1deg); }
            20% { transform: translate(-3px, 0px) rotate(1deg); }
            30% { transform: translate(3px, 2px) rotate(0deg); }
            40% { transform: translate(1px, -1px) rotate(1deg); }
            50% { transform: translate(-1px, 2px) rotate(-1deg); }
            60% { transform: translate(-3px, 1px) rotate(0deg); }
            70% { transform: translate(3px, 1px) rotate(-1deg); }
            80% { transform: translate(-1px, -1px) rotate(1deg); }
            90% { transform: translate(1px, 2px) rotate(0deg); }
            100% { transform: translate(1px, -2px) rotate(-1deg); }
        }

        /* æ‰‹æ©Ÿç‰ˆéŸ¿æ‡‰å¼ */
        @media (max-width: 768px) {
            .game-container {
                flex-direction: column;
            }
            .right-panel {
                height: 300px;
            }
        }
    </style>
</head>
<body>

    <div class="game-container">
        <!-- å·¦å´é¢æ¿ -->
        <div class="left-panel">
            <h1>è¨ä¼ç‹›å…‹ï¼</h1>
            
            <div class="hp-bar-container" id="hp-container">
                <div class="hp-bar-fill" id="hp-bar"></div>
                <span class="hp-text" id="hp-text">Loading...</span>
            </div>
    
            <div class="monster-box" id="monster">ğŸº</div>
    
            <button id="action-btn" onclick="handleBtnClick()">
                <span class="btn-text" id="btn-text">âš”ï¸ æ”»æ“Š</span>
                <span class="cooldown-overlay" id="cooldown-bar"></span>
            </button>
        </div>

        <!-- å³å´é¢æ¿ -->
        <div class="right-panel">
            <div class="log-header">æˆ°é¬¥ç´€éŒ„</div>
            <div class="log-area" id="game-log">
                <div class="log-entry type-system">é­é‡äº†é‡ç”Ÿçš„ç‹›å…‹ï¼</div>
            </div>
        </div>
    </div>

    <script>
        // --- 1. éŠæˆ²ç‹€æ…‹è®Šæ•¸ ---
        let monsterMaxHp = 0;
        let monsterCurrentHp = 0;
        let isBattleOver = false;
        const cooldownTime = 3000;

        // --- 2. æ­¦å™¨è³‡æ–™åº« ---
        const weapons = [
            {"col1": "ä½ ç”¨å°æç´ç ¸å‘ç‹›å…‹ï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 1, "max": 100}, {"col1": "ä½ æ‹¿èµ·çƒæ£’ç ¸å‘ç‹›å…‹ï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 1, "max": 70}, {"col1": "ä½ ç”¨å†°æ¤åˆºå‘ç‹›å…‹ï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 1, "max": 100}, {"col1": "ä½ ç”¨å·¨å¤§çš„æœ¨æ§Œæ§Œå‘ç‹›å…‹ï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 1, "max": 100}, {"col1": "ä½ ç”¨å°æç´ç ¸å‘ç‹›å…‹ï¼Œç„¶è€Œç‹›å…‹æ¯”è¼ƒè€æ‰“ï¼Œåªé€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 1, "max": 40}, {"col1": "ä½ ç”¨éæ´²äººçš„æ€¨å¿µç‡ƒç‡’ç‹›å…‹ï¼Œé€ æˆäº†", "col2": "é»çœŸå¯¦å‚·å®³ã€‚", "min": 50, "max": 150}, {"col1": "ä½ ç”¨æ²–å¤©ç‚®è½Ÿç‚¸ç‹›å…‹ï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 1, "max": 100}, {"col1": "ä½ ç”¨é£›çŸ›å°„å‘ç‹›å…‹ï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 10, "max": 120}, {"col1": "ä½ ç”¨éª¨é ­ä¸Ÿå‘ç‹›å…‹ï¼Œå‚·å®³ç›¸ç•¶é¡¯è‘—ï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 70, "max": 140}, {"col1": "ä½ ç”¨æ‹³é ­æå‘ç‹›å…‹ï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 1, "max": 80}, {"col1": "ä½ æ‹¿willisomeçš„æ±è¥¿ä¸Ÿå‘ç‹›å…‹ï¼Œç‹›å…‹æœæ–·çš„æ’²æ¥äº†ï¼Œä¸¦å¾€æ—é‚Šä¸€ç”©ã€‚", "col2": "å¾ˆéºæ†¾çš„ï¼Œå®Œå…¨æ²’æœ‰å‚·å®³ã€‚", "min": 0, "max": 0}, {"col1": "ä½ ç”¨é•·é•·çš„æœ¨æ£’è²«ç©¿äº†ç‹›å…‹ï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 50, "max": 100}, {"col1": "ä½ å¬å–šæ´ªæ°´è¥²å‘ç‹›å…‹ï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ã€‚éå¸¸éºæ†¾ï¼ŒåŒ—æ¥µç‹¼é‚„æ˜¯æœƒæ¸¸æ³³çš„ã€‚", "min": 1, "max": 10}, {"col1": "ä½ ç”¨èº«é«˜é„™è¦–ç‹›å…‹ï¼Œé€ æˆäº†", "col2": "é»çœŸå¯¦å‚·å®³ã€‚", "min": 80, "max": 180}, {"col1": "ä½ ç”¨è‚šè‚šå£“ä½ç‹›å…‹ï¼Œé€ æˆäº†...", "col2": "ä¸ï¼Œç‹›å…‹çœ‹èµ·ä¾†éå¸¸äº«å—ï¼Œå‚·å®³è¢«å…ç–«æ‰äº†ã€‚", "min": 0, "max": 0}, {"col1": "ä½ å¬é›·åŠˆå‘ç‹›å…‹ï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 1, "max": 140}, {"col1": "ä½ æŠ„èµ·ä¸€æŠŠæ‰‡å­ç›´æ“Šç‹›å…‹é¢é–€ï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 1, "max": 60}, {"col1": "ä½ æŠ½åˆ€æ–¬å‘ç‹›å…‹ï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 30, "max": 110}, {"col1": "ä½ ç”¨å·§å…‹åŠ›ä¸Ÿå‘ç‹›å…‹ï¼Œç‹›å…‹ç¬é–“æ¥ä½ä¸¦åƒæ‰äº†ã€‚ç‹›å…‹å›å¾©äº†", "col2": "é»è¡€é‡ã€‚", "min": -100, "max": -1}, {"col1": "ä½ æ’²æŠ±ç‹›å…‹ï¼Œé€ æˆäº†", "col2": "é»é©šåš‡å‚·å®³ï¼Œä¸¦ä¸”ç‹›å…‹é †æ‰‹å›æŠ±äº†ä½ ã€‚", "min": 1, "max": 5}, {"col1": "ä½ ç”¨è…³è¸¹å‘ç‹›å…‹ï¼Œç²¾æº–å‘½ä¸­è¦å®³ï¼Œé€ æˆäº†ä¸å¯è¨€å–»çš„å‚·å®³ã€‚", "col2": "a", "min": 150, "max": 300}, {"col1": "ä½ å¾å¾Œé¢æ¥è¿‘ç‹›å…‹ä¸¦çªç„¶æŠ“ä½å°¾å·´ï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ã€‚ä¼¼ä¹æ˜¯è¢«åš‡åˆ°çš„é—œä¿‚ï¼Œä½ è½åˆ°ç‹›å…‹ç™¼å‡ºæ‚¶å“¼è²ã€‚", "min": 1, "max": 20}, {"col1": "ä½ ç”¨æ‹‰éºµä¸Ÿå‘ç‹›å…‹ï¼Œç‹›å…‹é¿é–‹äº†ç¢—åƒå®Œäº†æ‹‰éºµï¼Œä¸åªæ²’é€ æˆå‚·å®³ï¼Œç”šè‡³å›å¾©äº†", "col2": "é»è¡€é‡ã€‚", "min": -100, "max": -1}, {"col1": "ä½ ç”¨æ¿å‡³ç ¸å‘ç‹›å…‹ï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 100, "max": 150}, {"col1": "ä½ åœ¨ç‹›å…‹çš„æ™šé¤è£¡å·å·æ”¾äº†è¾£æ¤’ï¼Œåƒä¸‹å»çš„ç‹›å…‹å—åˆ°äº†", "col2": "é»å‚·å®³ã€‚", "min": 40, "max": 100}, {"col1": "ä½ åœ¨ç‹›å…‹è€³æœµæ—é‚Šçªç„¶å¹æ°£ï¼Œé€ æˆäº†", "col2": "é»é©šåš‡å‚·å®³ã€‚ç‹›å…‹ç¬é–“è·³èµ·ä¾†é é›¢ä½ äº”å…¬å°ºï¼Œçœ‹ä¾†åš‡å¾—ä¸è¼•ã€‚", "min": 1, "max": 100}, {"col1": "ä½ éš¨ä¾¿æ‹¿å€‹ä»€éº¼å°±ç ¸å‘ç‹›å…‹ï¼Œä¸Ÿå‡ºå»çš„å†·å‡ç‰›æ’å‚·å®³é¡¯è‘—ï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 150, "max": 200}, {"col1": "ä½ éš¨ä¾¿æ‹¿å€‹ä»€éº¼å°±ç ¸å‘ç‹›å…‹ï¼Œä¸Ÿå‡ºå»çš„å¸ƒå¶å‚·å®³è–„å¼±ï¼Œå°ç‹›å…‹é€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 1, "max": 5}, {"col1": "ä½ éš¨ä¾¿æ‹¿å€‹ä»€éº¼å°±ç ¸å‘ç‹›å…‹ï¼Œä¸Ÿå‡ºå»çš„éº»å°‡å°ç‹›å…‹é€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 1, "max": 100}, {"col1": "ä½ éš¨ä¾¿æ‹¿å€‹ä»€éº¼å°±ç ¸å‘ç‹›å…‹ï¼Œä¸Ÿå‡ºå»çš„å®ˆè­·ç¥å°å°ç½ä¸­è·³å‡ºäº†æ°´æ˜Ÿç¥ï¼Œå¹«ç‹›å…‹å›å¾©äº†", "col2": "é»è¡€é‡ã€‚", "min": -80, "max": -40}, {"col1": "ä½ åœ¨ç‹›å…‹é¢å‰èƒ¡å‡ºäº†åœ‹å£«ç„¡é›™ï¼Œé€ æˆäº†", "col2": "é»çœŸå¯¦å‚·å®³ã€‚", "min": 80, "max": 120}, {"col1": "ä½ æŠŠé»‘ç³–çå¥¶ä¸Ÿçµ¦ç‹›å…‹ï¼Œç‹›å…‹æ„Ÿæ¿€åœ°æ¥ä½ä¸¦ä¸”é–‹å§‹ç‹‚å–ï¼Œå›å¾©äº†", "col2": "é»è¡€é‡ã€‚", "min": -150, "max": -50}, {"col1": "ä½ æ‹‰é–‹ç‹›å…‹çš„è¡£é ˜æŠŠå†°å¡Šä¸Ÿé€²å»ï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ï¼Œç„¶å¾ŒæŠ—å¯’çš„é›ªç‹¼ç‹›å…‹æ·¡å®šçš„æ‹¿å‡ºä¾†äº†ã€‚", "min": 1, "max": 10}, {"col1": "ä½ æŠŠæœ‰å¾ˆå¤šç¸å¤ªçš„ã€Œæ•™å­¸å½±ç‰‡ã€å‚³é€çµ¦ç‹›å…‹ï¼Œä¸Šèª²ä¸å°å¿ƒæ‰“é–‹èŠå¤©å®¤çš„ç‹›å…‹ç´…è‘—è‡‰è¡å‡ºæ•™å®¤ï¼Œé€ æˆäº†", "col2": "é»æ³¢è˜­çœŸå¯¦å‚·å®³ã€‚", "min": 20, "max": 30}, {"col1": "ä½ ç”¨å­—å…¸ç ¸å‘ç‹›å…‹ï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 1, "max": 100}, {"col1": "ä½ ç”¨é‘½çŸ³åŠåˆºå‘ç‹›å…‹ï¼Œç‹›å…‹èˆ‰ç›¾é˜²ç¦¦ï¼Œåªé€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 1, "max": 20}, {"col1": "ä½ æå‡ºä¸€æŠŠPKMå°ç‹›å…‹æƒå°„ï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 100, "max": 200}, {"col1": "ä½ æå‡ºä¸€æŠŠPKMå°ç‹›å…‹æƒå°„ï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 100, "max": 200}, {"col1": "ä½ æå‡ºä¸€æŠŠPKMå°ç‹›å…‹æƒå°„ï¼Œé€ æˆäº†...", "col2": "ç‹›å…‹çš„å¶çˆ¾é˜²å½ˆç‰¹æ€§è§¸ç™¼äº†ï¼Œæ²’æœ‰é€ æˆå‚·å®³ã€‚", "min": 0, "max": 0}, {"col1": "ä½ åœ¨ç‹›å…‹è€³é‚Šè¼•è²èªªé“ã€ŒTEmPTaTiONã€ï¼Œç‹›å…‹çš„æ‰‹è‡‚ä¸è‡ªè¦ºçš„é–‹å§‹ç— ç—›ï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 1, "max": 80}, {"col1": "ä½ Lost Riveräº†ç‹›å…‹ï¼Œé€ æˆäº†", "col2": "é»çœŸå¯¦å‚·å®³ã€‚", "min": 100, "max": 180}, {"col1": "ä½ ç”¨æ¡Œé›»ä¸»æ©Ÿç ¸å‘ç‹›å…‹ï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 50, "max": 150}, {"col1": "ä½ ç”¨äººå­”è“‹æ€ç¿»ç‹›å…‹ï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 1, "max": 100}, {"col1": "ä½ /tp ç‹›å…‹ 0 -64 0ï¼Œé€ æˆäº†", "col2": "é»è™›ç©ºå‚·å®³ã€‚", "min": 20, "max": 150}, {"col1": "ä½ èˆ‰èµ·äº†å£“è·¯æ©Ÿä¸Ÿå‘ç‹›å…‹ï¼Œç‹›å…‹èªªäº†å¥ã€Œæ˜¯å’Œæˆ‘åŒé¡å‹çš„æ›¿èº«å‘¢ã€ä¹‹å¾Œå°±ç¬é–“ç§»å‹•åˆ°ä½ é¢å‰ã€‚", "col2": "å¾ˆéºæ†¾ï¼Œæ²’æœ‰å‘½ä¸­ã€‚", "min": 0, "max": 0}, {"col1": "ä½ æŠŠç‹›å…‹åŸ‹é€²é›ªåœ°è£¡ï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ï¼Œç„¶å¾ŒæŠ—å¯’çš„é›ªç‹¼ç‹›å…‹åœ¨åœ°ä¸Šåšå‡ºäº†é›ªå¤©ä½¿ã€‚", "min": 1, "max": 15}, {"col1": "ä½ æŠŠé¦¬éˆ´è–¯ç ¸å‘ç‹›å…‹ï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 1, "max": 60}, {"col1": "ä½ æŠŠç‹›å…‹åœ‹ä¸­æ™‚çš„ç¾¤çµ„èŠå¤©ç´€éŒ„çµ¦ç‹›å…‹çœ‹ï¼Œç‹›å…‹åªçœ‹äº†ä¸€çœ¼å°±é©šæ…Œå¤±æªçš„ç‹‚å¥”ï¼Œé€ æˆäº†", "col2": "é»çœŸå¯¦å‚·å®³ã€‚", "min": 120, "max": 200}, {"col1": "ä½ æ™®æ”»å·´é¾ä¹‹å¾Œä¸Ÿä¸‹è¢«æ“Šé£›çš„ç‹›å…‹èµ°æ‰ï¼Œå·´é¾å°ç‹›å…‹é€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 10, "max": 100}, {"col1": "ä½ ç”¨Pockyåˆºå‘ç‹›å…‹ï¼Œç‹›å…‹æ•æ·çš„å¼ä½å¦å¤–ä¸€ç«¯åƒæ‰äº†ã€‚ç‹›å…‹å›å¾©äº†", "col2": "é»è¡€é‡ã€‚", "min": -50, "max": -1}, {"col1": "ä½ åœ¨å…«æœˆæŠŠç‹›å…‹æ‹–å‡ºæˆ¿é–“ï¼Œç‹›å…‹ç¬é–“èåŒ–æˆæ¶²é«”ï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 1, "max": 100}, {"col1": "ä½ å°ç‹›å…‹æ‰“å‡ºäº†ä¸€çµ„åŒèŠ±é †ã€‚é€ æˆäº†...", "col2": "ç‹›å…‹æ‰“å‡ºä¸€å¼µè¿´è½‰ï¼Œæ”»æ“Šè¢«å…ç–«äº†ã€‚", "min": 0, "max": 0}, {"col1": "ä½ ç„¡è²ç„¡æ¯çš„ç«™åœ¨ç‹›å…‹èƒŒå¾Œï¼Œååˆ†é˜å¾Œè½‰é ­çš„ç‹›å…‹å—šæ±ªå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šï¼", "col2": "a", "min": 20, "max": 80}, {"col1": "ä½ ç”¨é­å­æŠ½å‘ç‹›å…‹ï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 1, "max": 100}, {"col1": "ä½ ç”¨æ¤°å­ä¸Ÿå‘ç‹›å…‹ï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 20, "max": 120}, {"col1": "ä½ ç”¨æ¿ç£šæ‹å‘ç‹›å…‹ï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 1, "max": 90}, {"col1": "ä½ åœ¨ç‹›å…‹é™„è¿‘å‰–é–‹äº†æ¦´æ§¤ï¼Œå°é¼»å­éˆæ•çš„ç‹›å…‹é€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 40, "max": 70}, {"col1": "ä½ ç”¨åŠ äº†ç€‰è—¥çš„å·§å…‹åŠ›ä¸Ÿå‘ç‹›å…‹ï¼Œç‹›å…‹ç¬é–“æ¥ä½åƒæ‰ä¹‹å¾Œæ‰ç™¼ç¾ä¸å°å‹ã€‚åœ¨ä¸‰å°æ™‚å¾Œé€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 20, "max": 100}, {"col1": "ä½ æ‹‰è‘—ç‹›å…‹ä¸Šäº†è¨ˆç¨‹è»Šå¾å°åŒ—é–‹åˆ°é«˜é›„ï¼Œæ˜“æšˆè»Šçš„ç‹›å…‹åˆ°äº†ä¹‹å¾Œè·ªåœ°ç‹‚åã€‚é€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 30, "max": 120}, {"col1": "ä½ ç”¨èµ·å¸ç‰‡ç”©äº†ç‹›å…‹ä¸€å·´æŒï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 1, "max": 80}, {"col1": "ä½ åœ¨ç‹›å…‹é¢å‰è²·èµ°äº†æœ€å¾Œä¸€å€‹è–¯é¤…ï¼Œé€ æˆäº†", "col2": "é»çœŸå¯¦å‚·å®³ã€‚", "min": 70, "max": 120}, {"col1": "æœ¨æ¿ä¸è¶³ä»¥æ”¯æ’å…©å€‹äººçš„é‡é‡ï¼Œä½ æˆåŠŸæŠŠç‹›å…‹è¶•äº†ä¸‹æ°´ï¼Œå†°å†·çš„æµ·æ°´å°ç‹›å…‹é€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 40, "max": 90}, {"col1": "çœŸç›¸åªæœ‰ä¸€å€‹ï¼ä½ æŠŠéº»é†‰é‡å°„å‘äº†ç‹›å…‹çš„é ¸éƒ¨ï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 1, "max": 10}, {"col1": "ä½ è§¸ç™¼äº†é›ªç‹›botçš„bugï¼Œå’šï¼Discordæ²’æœ‰å›æ‡‰ï¼Œç‹›å…‹ä¾†ä¸åŠå„²å­˜å‰›å‰›å¯«çš„ç¨‹å¼ã€‚å…©å°æ™‚å¿ƒè¡€ç™½è²»çš„ç‹›å…‹å—åˆ°", "col2": "é»çœŸå¯¦å‚·å®³ã€‚", "min": 100, "max": 150}, {"col1": "ç‹›å…‹å¤ªä¹…æ²’æœ‰å›å»ä»¥çˆ¾ç´¢æ‹‰ï¼Œä½ å‘ŠçŸ¥ç‹›å…‹å…©éš»å°ç‹¸è²“æ±ºå®šé›¢ä»–è€Œå»çš„æ¶ˆæ¯ï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 80, "max": 120}, {"col1": "ä½ å·å·æºœé€²äº†ç‹›å…‹çš„æˆ¿é–“ï¼ŒæŠŠDiscordä»‹é¢è¨­å®šæˆæ˜äº®ï¼Œåœ¨æ·±å¤œä½¿ç”¨Discordçš„ç‹›å…‹å—åˆ°äº†", "col2": "é»å‚·å®³ã€‚", "min": 1, "max": 100}, {"col1": "ä½ ç”¨åŠ›æŠŠè¶³çƒè¸¢å‘ç‹›å…‹ï¼Œä½†æ˜¯ç‹›å…‹æˆåŠŸæŠ“ä½äº†ï¼Œå‘¨åœçš„å°æœ‹å‹ä¸€æ“è€Œä¸Šç¨±è®šç‹›å…‹ï¼Œè¢«æ²»ç™’çš„ç‹›å…‹å›å¾©äº†", "col2": "é»è¡€é‡ã€‚", "min": -100, "max": -1}, {"col1": "ä½ ç”¨æ­£å¤ªéŸ³å°è‘—ç‹›å…‹èªªã€Œã‚ã„ã—ã¦ã‚‹ã€ï¼Œå¿ƒè‡Ÿçˆ†æ“Šçš„ç‹›å…‹å›å¾©äº†", "col2": "é»è¡€é‡ï¼Œéš¨å³å¹¸ç¦çš„é–‰ä¸Šçœ¼ç›ã€‚", "min": -130, "max": -1}, {"col1": "ç‹›å…‹çˆ¬ä¸Šäº†ä¸€é€£ä¸²çš„éšæ¢¯ï¼Œå›åˆ°å®¿èˆç‹›å…‹æ‰ç™¼ç¾æ±è¥¿æ¼äº†åœ¨æ•™å®¤ï¼Œçœ‹è‘—é‚£åˆé•·åˆé™¡æ–œçš„éšæ¢¯ï¼Œç‹›å…‹å—åˆ°äº†", "col2": "é»çœŸå¯¦å‚·å®³ã€‚", "min": 1, "max": 150}, {"col1": "ä½ ä¸Šå‰è¿½å•ç‹›å…‹ä¹‹å‰çš„é»æ­Œæ´»å‹•ç”šéº¼æ™‚å€™å”±ä½ çš„æ­Œï¼Œç‹›å…‹å› ç‚ºå¿ƒç†å£“åŠ›å—åˆ°äº†", "col2": "é»çœŸå¯¦å‚·å®³ã€‚", "min": 1, "max": 70}, {"col1": "ä½ æŠŠçå¥¶ä¸Ÿçµ¦ç‹›å…‹ï¼Œç‹›å…‹æ„Ÿæ¿€åœ°æ¥ä½ä¸¦ä¸”é–‹å§‹ç‹‚å–æ‰ç™¼ç¾é‚£æ˜¯ç„¡ç³–çš„ï¼Œç‹›å…‹å—åˆ°äº†", "col2": "é»å‚·å®³ã€‚", "min": 50, "max": 150}, {"col1": "ä½ æ‰¯è‘—ç‹›å…‹çš„æ¯›è©¦åœ–æŠŠè—è‰²çš„éƒ¨åˆ†æ’•æ‰ï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 1, "max": 100}, {"col1": "ä½ ç”¨çƒ¤åå¸ç ¸å‘ç‹›å…‹ï¼Œç‹›å…‹é£›æ’²ä¸¦ç¬é–“å•ƒå®Œï¼Œå›å¾©äº†", "col2": "é»è¡€é‡ã€‚", "min": -80, "max": -40}, {"col1": "ä½ æŠŠç‹›å…‹Live a Heroå¸³è™Ÿçš„çŸ³é ­æŠ½å…‰ï¼Œè€Œä¸”é‚„æ²’æŠ½åˆ°ä»»ä½•æ–°è§’ï¼Œç‹›å…‹å—åˆ°äº†", "col2": "é»çœŸå¯¦å‚·å®³ï¼Œè€Œä¸”ç‹›å…‹å¾ä»Šä»¥å¾Œéƒ½æœƒæ¨ä½ ã€‚", "min": 100, "max": 120}, {"col1": "ä½ ä¸å°å¿ƒæŠŠé¬§é¬¼é­”é¡ç©è£‚ï¼Œé‚„ç•™åœ¨é¬¼å±‹è£¡çš„ç‹›å…‹ç¬é–“è¢«é¬¼...", "col2": "ç‹›å…‹å…‰é€Ÿç‡’æ‰æ‰‹ä¸Šçš„è–æœ¨ï¼Œé€ƒéäº†é¬¼çš„æ”»æ“Šã€‚", "min": 0, "max": 0}, {"col1": "ä½ å’¬äº†ç‹›å…‹ä¸€å£ï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 1, "max": 50}, {"col1": "ä½ åœ¨ç‹›å…‹æ‰“Maimaiæ™‚é€£æ©Ÿæ•…æ„é¸äº†é‚£å€‹å¾ˆæœƒé­”æ³•çš„é˜¿å¬¤ï¼Œå®Œå…¨è·Ÿä¸ä¸Šçš„ç‹›å…‹ä¸å°å¿ƒæ’åˆ°æŒ‡ç”²ï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 60, "max": 140}, {"col1": "ä½ ç”¨å­—å…¸ç ¸å‘ç‹›å…‹ï¼Œå¯æ˜¯æ˜¯ç”¨è§’ï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 1, "max": 150}, {"col1": "ä½ æ•…æ„æ¨è–¦äº†ä¸€æœ¬é‚„æ²’å®Œçµçš„å°èªªçµ¦ç‹›å…‹ï¼Œçœ‹å®Œå»çœ‹ä¸åˆ°çµå±€çš„ç‹›å…‹ç”¢ç”Ÿäº†å¼·çƒˆçš„æ€¨å¿µï¼Œé€ æˆäº†", "col2": "é»çœŸå¯¦å‚·å®³ã€‚", "min": 1, "max": 80}, {"col1": "ä½ ç™¼ç¾ç‹›å…‹æˆ¿é–“æ²’é–èµ°äº†é€²å»ï¼Œèººåœ¨åºŠä¸Šçš„ç‹›å…‹å—šæ±ªå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šå•Šï¼", "col2": "a", "min": 100, "max": 200}, {"col1": "ä½ ç”¨æ£’çƒä¸Ÿå‘ç‹›å…‹ï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 1, "max": 100}, {"col1": "ä½ ç”¨åå­—æ¶ç ¸å‘ç‹›å…‹ï¼Œå¾ˆå¯æƒœç‹›å…‹æ˜¯ç¥è–å±¬æ€§ä¸æœƒè¢«è¶…æ¸¡ï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 1, "max": 10}, {"col1": "ä½ ç”¨èåŒ–çš„å†°æ·‡æ·‹ç ¸å‘ç‹›å…‹ï¼Œå…¨èº«è®Šå¾—é»ç­”ç­”çš„ç‹›å…‹ç²¾ç¥ä¸å ªé‡è² ï¼Œé€ æˆäº†", "col2": "é»çœŸå¯¦å‚·å®³ã€‚", "min": 70, "max": 170}, {"col1": "ä½ æ‹¿è‘—é›ªèŠ±å†°æœç‹›å…‹çŒä¸‹å»ï¼Œç‹›å…‹æˆåŠŸåœ¨ç¢—åˆ°é”åœ°é¢å‰å…¨éƒ¨è§£æ±ºï¼Œå›å¾©äº†", "col2": "é»è¡€é‡ã€‚", "min": -90, "max": -30}, {"col1": "ä½ ç”¨åœ¨å¤ªé™½ä¸‹æ›¬äº†ä¸‰å°æ™‚çš„éµæ¿è¥²å‘ç‹›å…‹ï¼Œç‹›å…‹ç”¨é­”æ³•å¼·åˆ¶é™æº«ï¼Œåªé€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 1, "max": 30}, {"col1": "ä½ ç”¨é£›é¢å°„å‘ç‹›å…‹ï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 1, "max": 100}, {"col1": "ä½ æ‹¿ç‡’æˆç„¦ç‚­çš„åå¸å¼·åˆ¶é¤µé£Ÿç‹›å…‹ï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 50, "max": 120}, {"col1": "ä½ å«ä¾†äº†FBIï¼Œè¢«å¸¶èµ°å¯©è¨Šçš„ç‹›å…‹è¢«FBIé€ æˆäº†", "col2": "é»å‚·å®³ï¼Œè€Œä¸”ç‹›å…‹é›™è…¿ç™¼è»Ÿçš„å›ä¾†ã€‚", "min": 100, "max": 200}, {"col1": "ä½ åœ¨ç‹›å…‹åœ¨çš„èªéŸ³é »é“è£¡ç‚¸éº¥ï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 1, "max": 100}, {"col1": "ä½ åœ¨è·Ÿç‹›å…‹å‰ªåˆ€çŸ³é ­å¸ƒçš„æ™‚å€™å¾€ç‹›å…‹è‡‰ä¸Šå‡ºäº†çŸ³é ­ï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 1, "max": 70}, {"col1": "ä½ æŠŠç‹›å…‹çš„æ£‰è¢«æ¶èµ°ï¼Œé€ æˆäº†", "col2": "é»å¯’æ°£å‚·å®³ã€‚", "min": 50, "max": 100}, {"col1": "ä½ æ‰¯è‘—ç‹›å…‹çš„æ¯›è©¦åœ–æŠŠè—è‰²çš„éƒ¨åˆ†æ’•æ‰ï¼Œé€ æˆäº†...", "col2": "ç‹›å…‹æŠ“ä½ä½ æ‹¿èµ·ä¸€æ†è—è‰²è† å¸¶æŠŠä½ çºæˆæœ¨ä¹ƒä¼Šï¼Œåéä¾†å°ä½ é€ æˆäº†owowowoé»å‚·å®³ã€‚", "min": 0, "max": 0}, {"col1": "ä½ æƒ³ä¸åˆ°è©²æ€éº¼æ‰“ç‹›å…‹ï¼Œä½†æ˜¯ç‹›å…‹ä»ç„¶å—åˆ°äº†", "col2": "é»å‚·å®³ã€‚", "min": 1, "max": 100}, {"col1": "ä½ é–‹è‘—å¡è»Šæ’å‘å¼è‘—åå¸å‰›è·‘åˆ°è·¯å£çš„ç‹›å…‹ï¼Œç‹›å…‹å—åˆ°äº†", "col2": "é»å‚·å®³ã€‚", "min": 50, "max": 250}, {"col1": "ä½ é–‹è‘—å¡è»Šæ’å‘å¼è‘—åå¸å‰›è·‘åˆ°è·¯å£çš„ç‹›å…‹ï¼Œç‹›å…‹å—åˆ°äº†...", "col2": "ç‹›å…‹èº«ä¸Šç™¼å‡ºå¥³ç¥çš„å…‰èŠ’ï¼ä½ è¢«å‚³é€åˆ°ç•°ä¸–ç•Œäº†ï¼", "min": 0, "max": 0}, {"col1": "ä½ æå‡ºç²¾éˆçƒå¾€ç‹›å…‹é ­é ‚bonkä¸‹å»ï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 50, "max": 100}, {"col1": "ä½ åœ¨æ®¯å„€å¸«ç‹›å…‹é¢å‰æŠŠé´¨è…¿çµ¦å ±è­¦äº†ï¼Œé€ æˆäº†", "col2": "é»çœŸå¯¦å‚·å®³ï¼Œä¸¦ä¸”ä»–æœƒæ¨ä½ ã€‚", "min": 40, "max": 90}, {"col1": "ä½ æ‹¿ç†Šçš®è¢‹æŠŠç‹›å…‹æ•´éš»è£èµ·ä¾†ç¶ä½ï¼Œé€ æˆäº†", "col2": "é»çª’æ¯å‚·å®³ã€‚", "min": 1, "max": 70}, {"col1": "ä½ å¼·è¡Œé¤µäº†ç‹›å…‹è€ä¹…å€¼1%çš„ç”Ÿç‹¼è‚‰ï¼Œä¸Šåä¸‹ç€‰çš„ç‹›å…‹å—åˆ°äº†", "col2": "é»å‚·å®³ã€‚", "min": 80, "max": 160}, {"col1": "ä½ ç”¨æœ›æ½®å¸å–ç‹›å…‹çš„éˆé­‚ï¼Œé€ æˆäº†", "col2": "é»çœŸå¯¦å‚·å®³ã€‚", "min": 40, "max": 100}, {"col1": "ä½ ç”¨é’é¸æœè‘—ç‹›å…‹å°„æ“Šï¼Œé€ æˆäº†...", "col2": "ç‹›å…‹è¿…é€Ÿä½ç§»ï¼Œèº²æ‰äº†é€™ç™¼æ”»æ“Šï¼", "min": 0, "max": 0}, {"col1": "ä½ å¡äº†ä¸€éš»é•·å¾—å¾ˆæ€ªçš„äº”æ ¼ç‹—çµ¦ç‹›å…‹ï¼Œå›æƒ³èµ·æŸæ¬¾æ‹¼åœ–éŠæˆ²ææ‡¼çš„ç‹›å…‹å—åˆ°äº†", "col2": "é»çœŸå¯¦å‚·å®³ã€‚", "min": 20, "max": 110}, {"col1": "ä½ å°ç‹›å…‹ä½¿ç”¨äº†å±éšªçš„æµï¼Œç‹›å…‹æ‹šæ­»é˜²ç¦¦ï¼Œä½†ä»ç„¶å—åˆ°äº†", "col2": "é»å‚·å®³ã€‚", "min": 100, "max": 200}, {"col1": "ä½ å°ç‹›å…‹ä½¿ç”¨äº†å±éšªçš„æµï¼Œé€ æˆäº†...", "col2": "ä½ å¿˜è¨˜ä½ æœ‰å±éšªçš„ç¼½äº†ï¼å±éšªçš„æµå°ä½ é€ æˆäº†owowowoé»å‚·å®³ï¼", "min": 0, "max": 0}, {"col1": "ä½ èˆ‰èµ·æ¶ˆé˜²æ–§ç å‘ç‹›å…‹ï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 70, "max": 150}, {"col1": "ä½ å°ç‹›å…‹ä½¿ç”¨äº†æ€¥æ•‘ï¼Œå›å¾©äº†", "col2": "é»è¡€é‡ã€‚", "min": -40, "max": -1}, {"col1": "ä½ å°ç‹›å…‹ä½¿ç”¨äº†æ€¥æ•‘ï¼Œå›å¾©äº†......å¤§å¤±æ•—ï¼ä½ çš„é†«ç™‚åŒ…æ•²åˆ°äº†ç‹›å…‹çš„è…³ï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ï¼Œä¸¦ä¸”ä¼´éš¨è‘—ç‹›å…‹çš„æ·’å²æ‚²é³´ã€‚", "min": 1, "max": 40}, {"col1": "ä½ å°ç‹›å…‹æ‰”äº†ä¸€å€‹é»‘è‰²çš„é…·ç›¤å­ï¼Œä¸Šé¢çš„æ¯’å°ç‹›å…‹é€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 20, "max": 100}, {"col1": "ä½ ç”¨æ™®é€šå¿ƒç†å­¸èª²æœ¬ç ¸å‘ç‹›å…‹ï¼Œé€ æˆäº†", "col2": "é»å‚·å®³ã€‚", "min": 50, "max": 100}
        ];

        // --- 3. è¼”åŠ©å‡½å¼ ---
        function getDownHpChange(oldHp, newHp, threshold) {
            return (oldHp >= threshold && newHp < threshold);
        }

        function getUpHpChange(oldHp, newHp, threshold) {
            // "upåä¹‹"ï¼šåŸè¡€é‡åœ¨é–¾å€¼(å«)ä»¥ä¸‹ï¼Œæ–°è¡€é‡åœ¨é–¾å€¼ä»¥ä¸Š
            return (oldHp <= threshold && newHp > threshold);
        }

        // --- 4. éŠæˆ²åˆå§‹åŒ– ---
        function initGame() {
            monsterMaxHp = Math.floor(Math.random() * (1000 - 500 + 1)) + 500;
            monsterCurrentHp = monsterMaxHp;
            isBattleOver = false;

            // UI é‡ç½®
            const btn = document.getElementById('action-btn');
            const btnText = document.getElementById('btn-text');
            btn.classList.remove('btn-next');
            btn.disabled = false;
            btnText.textContent = "âš”ï¸ æ”»æ“Š";
            
            document.getElementById('monster').textContent = "ğŸº";
            logMessage(`------------------------------`, "type-system");
            logMessage(`æ–°çš„ç‹›å…‹å‡ºç¾äº†ï¼(HP: ${monsterMaxHp})`, "type-system");
            
            updateUI();
        }

        // --- 5. æŒ‰éˆ•é‚è¼¯ ---
        function handleBtnClick() {
            if (isBattleOver) {
                initGame();
                return;
            }
            performAttack();
        }

        // --- 6. æˆ°é¬¥é‚è¼¯ ---
        function performAttack() {
            const btn = document.getElementById('action-btn');
            const btnText = document.getElementById('btn-text');
            const cooldownBar = document.getElementById('cooldown-bar');

            // éš¨æ©Ÿé¸æ“‡æ­¦å™¨
            const weapon = weapons[Math.floor(Math.random() * weapons.length)];
            
            // è¨ˆç®—æ•¸å€¼ (è² æ•¸=è£œè¡€, æ­£æ•¸=å‚·å®³)
            let value = 0;
            if (weapon.min !== 0 || weapon.max !== 0) {
                value = Math.floor(Math.random() * (weapon.max - weapon.min + 1)) + weapon.min;
            }

            processEffect(weapon, value);

            // è§¸ç™¼å†·å»å‹•ç•«
            btn.disabled = true;
            btnText.textContent = "å……èƒ½ä¸­...";
            cooldownBar.style.transition = 'none';
            cooldownBar.style.width = '0%';
            void cooldownBar.offsetWidth; // å¼·åˆ¶é‡ç¹ª
            cooldownBar.style.transition = `width ${cooldownTime}ms linear`;
            cooldownBar.style.width = '100%';

            setTimeout(() => {
                if (!isBattleOver) {
                    btn.disabled = false;
                    btnText.textContent = "âš”ï¸ æ”»æ“Š";
                }
                cooldownBar.style.transition = 'none';
                cooldownBar.style.width = '0%';
            }, cooldownTime);
        }

        function processEffect(weapon, value) {
            const monsterElem = document.getElementById('monster');
            let logType = "";
            let message = "";
            const isMiss = (weapon.min === 0 && weapon.max === 0);

            // 1. ç”¢ç”ŸåŸºç¤è¨Šæ¯
            if (isMiss) {
                message = `${weapon.col1}<br>${weapon.col2}`;
                logType = "type-miss";
            } else if (weapon.col2 === "a") {
                message = weapon.col1;
                if (value < 0) logType = "type-heal";
                else logType = "type-damage";
            } else {
                message = `${weapon.col1} <strong>${Math.abs(value)}</strong> ${weapon.col2}`;
                if (value < 0) logType = "type-heal";
                else logType = "type-damage";
            }

            // æ›¿æ› owowowo
            if (message.includes("owowowo")) {
                const randomVal = Math.floor(Math.random() * 100) + 1;
                message = message.replace(/owowowo/g, `<strong>${randomVal}</strong>`);
            }

            // 2. è¨ˆç®—è¡€é‡è®ŠåŒ–èˆ‡ç‰¹æ®Šç‹€æ…‹
            const oldHp = monsterCurrentHp;
            let newHp = monsterCurrentHp;
            
            if (!isMiss) {
                newHp -= value; // å‚·å®³ç‚ºæ­£ï¼Œæ‰€ä»¥æ¸›å» value (è£œè¡€ç‚ºè² ï¼Œæ¸›å»è² å€¼è®ŠåŠ )
            }
            
            // æ³¨æ„ï¼šé€™è£¡ä¸è¨­å®šä¸Šé™ï¼Œå…è¨±éé‡è£œè¡€ (Overheal)
            if (newHp < 0) newHp = 0;

            // 3. æª¢æŸ¥ç‰¹æ®Šé–¾å€¼å°è©±
            let statusMessage = "";
            if (getDownHpChange(oldHp, newHp, 100)) {
                statusMessage = "ç‹›å…‹çœ‹èµ·ä¾†å·²ç¶“æ²’æœ‰åŠ›æ°£æ™æ‰äº†ï¼";
            } else if (getDownHpChange(oldHp, newHp, 300)) {
                statusMessage = "ç‹›å…‹çœ‹èµ·ä¾†éå¸¸çš„è™›å¼±ï¼";
            } else if (getUpHpChange(oldHp, newHp, 1500)) {
                statusMessage = "ç‹›å…‹å…¨èº«æ•£ç™¼è‘—ç¥è–çš„å…‰èŠ’ï¼";
            } else if (getUpHpChange(oldHp, newHp, 1000)) {
                statusMessage = "ç‹›å…‹æ„Ÿåˆ°å‰æ‰€æœªæœ‰çš„äº¢å¥®ï¼";
            } else if (getUpHpChange(oldHp, newHp, 100)) {
                statusMessage = "ç‹›å…‹ä»–é‡æ–°ç«™èµ·ä¾†äº†ï¼";
            }

            // 4. æ›´æ–°ç‹€æ…‹
            monsterCurrentHp = newHp;

            // 5. è¼¸å‡ºæ—¥èªŒ
            logMessage(message, logType);
            if (statusMessage) {
                logMessage(statusMessage, "type-status");
            }

            // 6. è¦–è¦ºæ›´æ–°
            if (value > 0) { // æœ‰é€ æˆå‚·å®³æ‰éœ‡å‹•
                monsterElem.classList.remove('shake');
                void monsterElem.offsetWidth;
                monsterElem.classList.add('shake');
            }

            updateUI();
        }

        function updateUI() {
            const hpBarFill = document.getElementById('hp-bar');
            const hpContainer = document.getElementById('hp-container');
            const monsterElem = document.getElementById('monster');
            const btn = document.getElementById('action-btn');
            const btnText = document.getElementById('btn-text');

            // è¨ˆç®—ç™¾åˆ†æ¯”ï¼Œè‹¥è¶…é 100% å°±é¡¯ç¤ºç‚º 100% ä½†åŠ ä¸Šç™¼å…‰ç‰¹æ•ˆ
            let percentage = (monsterCurrentHp / monsterMaxHp) * 100;
            let displayPercentage = percentage > 100 ? 100 : percentage;

            hpBarFill.style.width = displayPercentage + "%";
            document.getElementById('hp-text').textContent = `${monsterCurrentHp} / ${monsterMaxHp}`;

            // è™•ç†éé‡è£œè¡€ç‰¹æ•ˆ (Overheal)
            if (monsterCurrentHp > monsterMaxHp) {
                hpContainer.classList.add('overheal-glow');
                hpBarFill.classList.add('overheal-fill');
            } else {
                hpContainer.classList.remove('overheal-glow');
                hpBarFill.classList.remove('overheal-fill');
            }

            // è™•ç†æ­»äº¡é‚è¼¯
            if (monsterCurrentHp <= 0) {
                monsterElem.textContent = "â˜ ï¸";
                if (!isBattleOver) {
                    logMessage("æ­å–œï¼ä½ æˆåŠŸè¨ä¼äº†ç‹›å…‹ï¼", "type-damage");
                    isBattleOver = true;
                    // åˆ‡æ›æŒ‰éˆ•ç‹€æ…‹
                    btn.classList.add('btn-next');
                    btn.disabled = false; // ç¢ºä¿æŒ‰éˆ•å¯æŒ‰
                    btnText.textContent = "â© ä¸‹ä¸€éš»";
                    // ç§»é™¤å†·å»å‹•ç•«
                    document.getElementById('cooldown-bar').style.width = '0%';
                }
            } else {
                monsterElem.textContent = "ğŸº";
            }
        }

        function logMessage(msg, typeClass) {
            const logArea = document.getElementById('game-log');
            const entry = document.createElement('div');
            entry.className = `log-entry ${typeClass}`;
            entry.innerHTML = msg;
            // ä¿æŒæœ€æ–°çš„è¨Šæ¯åœ¨æœ€ä¸Šæ–¹
            logArea.insertBefore(entry, logArea.firstChild);
        }

        // å•Ÿå‹•éŠæˆ²
        initGame();

    </script>
</body>
</html>
